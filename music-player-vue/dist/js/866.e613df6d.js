"use strict";(self["webpackChunkmusic_player_vue"]=self["webpackChunkmusic_player_vue"]||[]).push([[866],{866:function(a,e,t){t.r(e),t.d(e,{default:function(){return I}});t(4114),t(8111),t(7588);var n=t(6768),i=t(144),r=t(5130),l=t(4232);const o={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"};var s=(0,n.pM)({name:"Search",render:function(a,e){return(0,n.uX)(),(0,n.CE)("svg",o,e[0]||(e[0]=[(0,n.Lk)("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8a124.95 124.95 0 0 1-124.8-124.8z",fill:"currentColor"},null,-1)]))}}),d=t(7378),c=t(6507),u=t(4151),m=t(506),p=t(2646),b=t(7966),g=t(7671),v=t(5446),h=t(1389);const f={style:{position:"relative"}},y={style:{height:"40vh","overflow-y":"auto"}},k={style:{margin:"1vw"}},w={style:{height:"35vh","overflow-y":"auto"}},C={key:0,style:{"text-align":"center"}},x={key:1,style:{"text-align":"center"}},F=["onClick"],A={style:{"text-align":"center"}},L={style:{"text-align":"center"}},_={style:{"text-align":"center"}},T={class:"pagination-wrapper"},R={class:"page-text"},j=10;var P={__name:"Home",setup(a){const e={Pagination:{itemTextColor:"#8f8f8f",itemTextColorHover:"#fff",itemTextColorPressed:"#fff",itemTextColorActive:"#fff",itemColor:"transparent",itemColorHover:"#FF3A3A20",itemColorPressed:"#FF3A3A30",itemColorActive:"#FF3A3A",itemBorderColor:"#404040",itemBorderRadius:"4px",buttonColor:"transparent",buttonColorHover:"#FF3A3A20",buttonColorPressed:"#FF3A3A30",jumpTextColor:"#8f8f8f",jumpTextColorHover:"#fff",jumpTextColorPressed:"#fff"},Button:{textColorQuaternary:"#8f8f8f",textColorQuaternaryHover:"#fff",textColorQuaternaryPressed:"#fff",colorQuaternaryHover:"#FF3A3A20",colorQuaternaryPressed:"#FF3A3A40"}},t=(0,i.KR)([{id:1303464858,avatar:"https://img2.baidu.com/it/u=3029837478,1144772205&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=500",name:"于是",singer:"郑润泽",album:"于是",duration:"3:52"},{id:2650083076,avatar:"https://q8.itc.cn/q_70/images03/20241030/7e4e379bf5b84b6c9fb4a9fec3102d5d.jpeg",name:"给我个理由",singer:"Zkaaai",album:"给我个理由",duration:"3:40"},{id:1435177840,avatar:"https://pic1.imgdb.cn/item/67ba76f3d0e0a243d4025a27.png",name:"Wonderful U",singer:"Zkaaai",album:"Wonderful U",duration:"4:27"},{id:2608136312,avatar:"https://pic1.imgdb.cn/item/67ba778cd0e0a243d4025a3f.png",name:"欲望都市",singer:"木由C",album:"欲望都市",duration:"2:41"},{id:1403318151,avatar:"https://pic1.imgdb.cn/item/67ba77efd0e0a243d4025a8c.png",name:"把回忆拼好给你",singer:"王贰浪",album:"把回忆拼好给你",duration:"6:21"},{id:2641867659,avatar:"https://pic1.imgdb.cn/item/67ba7803d0e0a243d4025a8d.png",name:"一点",singer:"Muyoi",album:"一点",duration:"3:20"},{id:1456890009,avatar:"https://pic1.imgdb.cn/item/67ba7818d0e0a243d4025a8e.png",name:"罗生门（Follow）",singer:"梨冻紧",album:"罗生门（Follow）",duration:"4:03"},{id:1393138949,avatar:"https://pic1.imgdb.cn/item/67ba782ad0e0a243d4025a90.png",name:"烂尾故事",singer:"梨冻紧",album:"烂尾故事",duration:"3:34"},{id:2611558270,avatar:"https://pic1.imgdb.cn/item/67ba7847d0e0a243d4025a94.png",name:"No Cap ( Phonk口水）",singer:"GuTs",album:"No Cap ( Phonk口水）",duration:"2:16"},{id:1895330088,avatar:"https://pic1.imgdb.cn/item/67ba785ad0e0a243d4025a97.png",name:"予你",singer:"队长",album:"予你",duration:"3:51"},{id:2674443509,avatar:"https://pic1.imgdb.cn/item/67ba80ced0e0a243d4025afc.png",name:"像晴天像雨天",singer:"汪苏泷",album:"像晴天像雨天",duration:"3:51"},{id:2049512697,avatar:"https://pic1.imgdb.cn/item/67ba80f2d0e0a243d4025b00.png",name:"向云端",singer:"海洋Bo",album:"向云端",duration:"4:11"},{id:1811752787,avatar:"https://pic1.imgdb.cn/item/67ba8109d0e0a243d4025b07.png",name:"u got my soul",singer:"bill",album:"u got my soul",duration:"3:46"},{id:2122953316,avatar:"https://pic1.imgdb.cn/item/67ba8140d0e0a243d4025b0c.png",name:"黑白天",singer:"邓亦宇",album:"黑白天",duration:"3:16"},{id:5257963,avatar:"https://pic1.imgdb.cn/item/67ba8162d0e0a243d4025b0e.png",name:"最佳损友",singer:"张学友",album:"最佳损友",duration:"4:03"},{id:1934630654,avatar:"https://pic1.imgdb.cn/item/67ba8187d0e0a243d4025b13.png",name:"十年",singer:"陈奕迅",album:"十年",duration:"3:06"},{id:1931647519,avatar:"https://pic1.imgdb.cn/item/67ba819ed0e0a243d4025b18.png",name:"够钟",singer:"阿梨粤",album:"够钟",duration:"4:16"},{id:346013,avatar:"https://pic1.imgdb.cn/item/67ba81b7d0e0a243d4025b4d.png",name:"海阔天空",singer:"黄贯中",album:"海阔天空",duration:"6:06"},{id:1824449700,avatar:"https://pic1.imgdb.cn/item/67ba81cfd0e0a243d4025b86.png",name:"富士山下（国粤版）（翻自 Eason",singer:"浮梦",album:"富士山下（国粤版）（翻自 Eason",duration:"4:16"},{id:2610953364,avatar:"https://pic1.imgdb.cn/item/67ba81e2d0e0a243d4025b9f.png",name:"在加纳共和国离婚 (你还爱我吗)",singer:"橙子",album:"在加纳共和国离婚 (你还爱我吗)",duration:"4:20"},{id:25657492,avatar:"https://pic1.imgdb.cn/item/67ba81f4d0e0a243d4025bbd.png",name:"Tik Tok (Live)",singer:"Avril Lavigne",album:"Tik Tok (Live)",duration:"4:20"},{id:1886396470,avatar:"https://pic1.imgdb.cn/item/67ba8206d0e0a243d4025bee.png",name:"勿念",singer:"岑宁儿",album:"勿念",duration:"3:26"},{id:2645500113,avatar:"https://pic1.imgdb.cn/item/67ba822dd0e0a243d4025c1d.png",name:"跳楼机",singer:"LBI利比",album:"跳楼机",duration:"3:26"},{id:2671228586,avatar:"https://pic1.imgdb.cn/item/67ba8255d0e0a243d4025c1e.png",name:"时间变",singer:"John Lee",album:"时间变",duration:"3:20"}]),o=(0,i.KR)(""),P=(0,i.KR)(1),E=(0,n.EW)((()=>Math.ceil(t.value.length/j))),$=(0,n.EW)((()=>{const a=(P.value-1)*j,e=a+j;return t.value.slice(a,e)}));function I(){const a=o.value.replace(/\s+/g,""),e=`https://music.163.com/api/search/get?s=${encodeURIComponent(a)}&type=1&offset=0&limit=15`;fetch(`https://${GetParentResourceName()}/fetchMusicData`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:e,useNewFormat:!0})})}function N(a){const e="string"===typeof a?JSON.parse(a):a;if(!e.result)return;const n=e.result.songs;Array.isArray(n)&&0!=n.length&&(t.value=[],P.value=1,n.forEach((a=>{let e={};e.id=a.id,e.name=a.name,e.singer="未知艺术家",a.artists&&a.artists[0]?e.singer=a.artists[0].name:a.ar&&a.ar[0]&&(e.singer=a.ar[0].name),e.avatar="https://pic1.imgdb.cn/item/67ba504dd0e0a243d4025680.jpg",a.album&&a.album.picUrl?e.avatar=a.album.picUrl:a.al&&a.al.picUrl&&(e.avatar=a.al.picUrl),e.album=a.album&&a.album.name?a.album.name:a.al&&a.al.name?a.al.name:"新晋歌手";let n=Math.floor(a.duration/1e3);e.duration=Math.floor(n/60)+":"+(n%60<10?"0"+n%60:n%60),e.url=`https://api.qijieya.cn/meting/?type=url&id=${a.id}`,e.lrc=`https://api.qijieya.cn/meting/?type=lrc&id=${a.id}`,t.value.push(e),Promise.all([fetch(`https://api.qijieya.cn/meting/?server=netease&type=song&id=${a.id}`),fetch(e.lrc)]).then((([a,e])=>{if(!a.ok)throw new Error("封面获取失败");if(!e.ok)throw new Error("歌词获取失败");return Promise.all([a.json(),e.text()])})).then((([n,i])=>{if(n&&n[0]&&n[0].pic){const e=t.value.findIndex((e=>e.id===a.id));-1!==e&&(t.value[e].avatar=n[0].pic,console.log(`歌曲 ${a.name} 封面已更新: ${n[0].pic}`))}const r=t.value.findIndex((e=>e.id===a.id));-1!==r&&(t.value[r].lrcData={id:a.id,name:a.name,artist:e.singer,album:e.album,duration:e.duration,avatar:n&&n[0]&&n[0].pic?n[0].pic:e.avatar,lrc:i,saveTime:(new Date).toISOString()},t.value[r].lrcText=i)})).catch((e=>{console.error(`获取歌曲 ${a.name} 信息失败:`,e)}))})))}function S(a){const[e,t]=a.split(":");return 60*parseInt(e)+parseInt(t)}function O(a){const e=m.L5.value.djTableId||"galaxy_club";fetch(`https://api.qijieya.cn/meting/?server=netease&type=song&id=${a.id}`).then((a=>a.json())).then((t=>{t&&t[0]&&t[0].pic?q(a,e,t[0].pic):q(a,e,a.avatar)})).catch((t=>{console.error("获取歌曲信息失败:",t),q(a,e,a.avatar)}))}function q(a,e,t){if(m.L5.value={...a,djTableId:e,avatar:t},console.log("Playing music:",{name:a.name,djTableId:e,avatar:t}),a.lrcData){const e=`${a.id}_${a.name.replace(/[^a-zA-Z0-9]/g,"")}.json`;fetch(`https://${GetParentResourceName()}/saveLyricsFile`,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({fileName:e,content:JSON.stringify(a.lrcData,null,2)})}).then((a=>a.json().catch((a=>(console.warn("解析响应JSON失败，使用默认值",a),{success:!0}))))).then((e=>{e&&e.success&&console.log(`歌曲 ${a.name} 的歌词已保存`)})).catch((a=>{console.error("保存歌词文件失败:",a)}))}fetch(`https://${GetParentResourceName()}/playMusic`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:`https://api.qijieya.cn/meting/?server=netease&type=url&id=${a.id}`,name:a.name,artist:a.singer,album:a.album,avatar:t,djTableId:e,volume:100,duration:S(a.duration),id:a.id})}).then((a=>{a.ok||console.error("Failed to play music:",a.statusText)})).catch((a=>{console.error("Error playing music:",a)}))}return window.addEventListener("message",(function(a){switch(a.data.action){case"musicData":N(a.data.data);break;default:break}})),(a,t)=>((0,n.uX)(),(0,n.Wv)((0,i.R1)(p.A),{"theme-overrides":e},{default:(0,n.k6)((()=>[(0,n.Lk)("div",f,[(0,n.bF)((0,i.R1)(b._),{size:"20",color:"#8f8f8f",component:(0,i.R1)(s),style:{position:"absolute",left:"2vw",top:"0.6vh"}},null,8,["component"]),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),onKeyup:(0,r.jR)(I,["enter"]),placeholder:"搜索歌曲",class:"search-input",style:{"padding-left":"3ch"}},null,544),[[r.Jo,o.value]])]),(0,n.Lk)("div",y,[(0,n.Lk)("table",k,[t[3]||(t[3]=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",{style:{width:"2vw","text-align":"center"}},"#"),(0,n.Lk)("th",{style:{width:"20vw","text-align":"start"}},"歌曲"),(0,n.Lk)("th",{style:{width:"5vw","text-align":"center"}},"歌手"),(0,n.Lk)("th",{style:{width:"10vw","text-align":"center"}},"专辑"),(0,n.Lk)("th",{style:{width:"3vw","text-align":"center"}},"时长")])],-1)),(0,n.Lk)("tbody",w,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)($.value,((a,e)=>((0,n.uX)(),(0,n.CE)("tr",{key:e,style:{height:"5vh"}},[(0,i.R1)(m.L5).id===a.id?((0,n.uX)(),(0,n.CE)("td",C,[(0,n.bF)((0,i.R1)(b._),{size:"20",color:"red",component:(0,i.R1)(d.A)},null,8,["component"])])):((0,n.uX)(),(0,n.CE)("td",x,(0,l.v_)((P.value-1)*j+e+1),1)),(0,n.Lk)("td",{style:{cursor:"pointer"},onClick:e=>O(a)},[(0,n.bF)((0,i.R1)(g.A),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(v.A),{size:"small",src:a.avatar},null,8,["src"]),(0,n.Lk)("div",null,(0,l.v_)(a.name),1)])),_:2},1024)],8,F),(0,n.Lk)("td",A,(0,l.v_)(a.singer),1),(0,n.Lk)("td",L,(0,l.v_)(a.album),1),(0,n.Lk)("td",_,(0,l.v_)(a.duration),1)])))),128))])])]),(0,n.Lk)("div",T,[(0,n.bF)((0,i.R1)(g.A),{align:"center",size:4},{default:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(h.Ay),{quaternary:"",circle:"",size:"small",disabled:1===P.value,onClick:t[1]||(t[1]=a=>P.value--)},{icon:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(b._),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(c.A))])),_:1})])),_:1},8,["disabled"]),(0,n.Lk)("span",R,(0,l.v_)(P.value)+"/"+(0,l.v_)(E.value),1),(0,n.bF)((0,i.R1)(h.Ay),{quaternary:"",circle:"",size:"small",disabled:P.value===E.value,onClick:t[2]||(t[2]=a=>P.value++)},{icon:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(b._),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(u.A))])),_:1})])),_:1},8,["disabled"])])),_:1})])])),_:1}))}},E=t(1241);const $=(0,E.A)(P,[["__scopeId","data-v-d0f8c24c"]]);var I=$}}]);
//# sourceMappingURL=866.e613df6d.js.map